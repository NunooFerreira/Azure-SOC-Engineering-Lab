let failedLogins = 
    SecurityEvent
    | where EventID == 4625
    | where isnotempty(IpAddress)
    | summarize FailCount = count(), FirstFail = min(TimeGenerated), LastFail = max(TimeGenerated) by IpAddress, Account;
let successfulLogins = 
    SecurityEvent
    | where EventID == 4624
    | where isnotempty(IpAddress)
    | project SuccessTime = TimeGenerated, IpAddress, Account;
failedLogins
| join kind=inner (successfulLogins) on IpAddress, Account
| where SuccessTime between (LastFail .. LastFail + 15m)
| project IpAddress, Account, FailCount, LastFail, SuccessTime, TimeDifference = SuccessTime - LastFail
